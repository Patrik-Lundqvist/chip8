parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"scas":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Chip8=exports.__wbindgen_throw=exports.__wbindgen_jsval_eq=exports.__wbindgen_is_undefined=exports.__wbindgen_object_drop_ref=exports.__wbg_randomFillSync_f9cb7531d9c0b144=exports.__wbg_require_36a895f0a4ea0529=exports.__wbg_getRandomValues_a3a3c2dd5494fd39=exports.__wbg_getRandomValues_58b46416ea7a33a2=exports.__wbg_crypto_c93cc5a147e35422=exports.__wbg_self_95ad3f1cddd5accc=exports.__wbg_call_e15b6aa0c6d3c93f=exports.__wbg_new_bc890df3e5e6a91d=exports.default=void 0;var _=e(require("./pkg/chip8_web_bg.wasm"));function e(_){return _&&_.__esModule?_:{default:_}}var a=_.default;exports.default=a;var d=_.default.__wbg_new_bc890df3e5e6a91d;exports.__wbg_new_bc890df3e5e6a91d=d;var r=_.default.__wbg_call_e15b6aa0c6d3c93f;exports.__wbg_call_e15b6aa0c6d3c93f=r;var t=_.default.__wbg_self_95ad3f1cddd5accc;exports.__wbg_self_95ad3f1cddd5accc=t;var b=_.default.__wbg_crypto_c93cc5a147e35422;exports.__wbg_crypto_c93cc5a147e35422=b;var c=_.default.__wbg_getRandomValues_58b46416ea7a33a2;exports.__wbg_getRandomValues_58b46416ea7a33a2=c;var o=_.default.__wbg_getRandomValues_a3a3c2dd5494fd39;exports.__wbg_getRandomValues_a3a3c2dd5494fd39=o;var n=_.default.__wbg_require_36a895f0a4ea0529;exports.__wbg_require_36a895f0a4ea0529=n;var s=_.default.__wbg_randomFillSync_f9cb7531d9c0b144;exports.__wbg_randomFillSync_f9cb7531d9c0b144=s;var f=_.default.__wbindgen_object_drop_ref;exports.__wbindgen_object_drop_ref=f;var g=_.default.__wbindgen_is_undefined;exports.__wbindgen_is_undefined=g;var l=_.default.__wbindgen_jsval_eq;exports.__wbindgen_jsval_eq=l;var w=_.default.__wbindgen_throw;exports.__wbindgen_throw=w;var p=_.default.Chip8;exports.Chip8=p;
},{"./pkg/chip8_web_bg.wasm":"ZIGB"}],"kXOT":[function(require,module,exports) {
module.exports="/chip8/PONG2.f37a7581.ch8";
},{}],"rka7":[function(require,module,exports) {
module.exports="/chip8/BRIX.2591edc2.ch8";
},{}],"5QL3":[function(require,module,exports) {
module.exports="/chip8/TETRIS.a7b06769.ch8";
},{}],"NAjt":[function(require,module,exports) {
module.exports="/chip8/UFO.4844620e.ch8";
},{}],"WfXF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fetchRom=exports.roms=void 0;var e=i(require("../roms/PONG2.ch8")),o=i(require("../roms/BRIX.ch8")),r=i(require("../roms/TETRIS.ch8")),t=i(require("../roms/UFO.ch8"));function i(e){return e&&e.__esModule?e:{default:e}}var d=[{name:"Ufo",file:t.default,keyMappings:[{emuKey:4,keyCode:81,description:"Q - Shoot left"},{emuKey:5,keyCode:87,description:"W - Shoot up"},{emuKey:6,keyCode:69,description:"E - Shoot right"}]},{name:"Pong",file:e.default,keyMappings:[{emuKey:1,keyCode:65,description:"A - Left paddle up"},{emuKey:4,keyCode:90,description:"Z - Left paddle down"},{emuKey:12,keyCode:75,description:"K - Right paddle up"},{emuKey:13,keyCode:77,description:"M - Right paddle down"}]},{name:"Brix",file:o.default,keyMappings:[{emuKey:4,keyCode:37,description:"Arrow Left - Move left"},{emuKey:6,keyCode:39,description:"Arrow Right - Move right"}]},{name:"Tetris",file:r.default,keyMappings:[{emuKey:5,keyCode:37,description:"Arrow Left - Move left"},{emuKey:6,keyCode:39,description:"Arrow Right - Move right"},{emuKey:7,keyCode:40,description:"Arrow Down - Drop"},{emuKey:4,keyCode:32,description:"Space - Rotate"}]}];exports.roms=d;var n=function(e){return fetch(e.file).then(function(e){if(!e.ok)throw new Error("Could not fetch rom");return e.body.getReader().read().then(function(e){return e})})};exports.fetchRom=n;
},{"../roms/PONG2.ch8":"kXOT","../roms/BRIX.ch8":"rka7","../roms/TETRIS.ch8":"5QL3","../roms/UFO.ch8":"NAjt"}],"cSo4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setupKeypad=void 0;var e=function(e,n,t){window.addEventListener("keydown",function(e){var t=o(e.keyCode);t&&n(t.emuKey)}),window.addEventListener("keyup",function(e){var n=o(e.keyCode);n&&t(n.emuKey)});var o=function(n){return e().find(function(e){return e.keyCode===n})}};exports.setupKeypad=e;
},{}],"9EpD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDisplay=void 0;var e=function(){var e=document.querySelector("canvas"),t=e.getContext("2d");return e.width=512,e.height=256,{drawPixels:function(e){for(var r=0;r<32;r++)for(var c=64*r,a=e.slice(c,c+64),i=0;i<64;i++)a[i]?(t.fillStyle="#26cdff",t.fillRect(8*i,8*r,8,8)):t.clearRect(8*i,8*r,8,8)}}};exports.createDisplay=e;
},{}],"WzDL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createUI=void 0;var e=function(e,t,n,c){var o=document.querySelector(".controls"),r=document.querySelector(".debug-box"),u=document.querySelector(".debug"),i=document.querySelector(".halt-button"),d=document.querySelector(".step-button"),a=document.querySelector(".debug-button"),l=document.querySelector(".next-game"),s=document.querySelector(".prev-game"),f=document.querySelector(".game-info-active"),v={},m=!1,p=function(e,t){var n=document.createElement("div");return n.classList.add("info-box-entry"),n.innerText=t,e.append(n),n},b=function(){m=!m,r.hidden=!m};return i.addEventListener("click",e),d.addEventListener("click",t),a.addEventListener("click",b),l.addEventListener("click",n),s.addEventListener("click",c),function(){v={pc:p(u,"PC"),i:p(u,"I")};for(var e=0;e<=15;e++)v["v".concat(e)]=p(u,"V".concat(e))}(),r.hidden=!m,{setGameLabel:function(e){f.innerText=e},updateDebugInfo:function(e,t,n){m&&(v.pc.innerText="PC: ".concat(e),v.i.innerText="I: ".concat(t),n.forEach(function(e,t){v["v".concat(t)].innerText="V".concat(t,": ").concat(e)}))},updateControls:function(e){for(;o.firstChild;)o.firstChild.remove();e.forEach(function(e){return p(o,e.description)})}}};exports.createUI=e;
},{}],"Y5Mt":[function(require,module,exports) {
"use strict";var e,n,t=require("../rs/Cargo.toml"),r=require("./roms"),o=require("./keypad"),i=require("./display"),u=require("./ui"),a=0,c=!0,s=!1,f=function(){var t=D.get_contents();e.drawPixels(t),n.updateDebugInfo(D.get_program_counter(),D.get_i_register(),D.get_v_register())},p=function(){D.execute_cycle(),f()},m=function(){D.execute_next_op_code(),f()},_=60,g=Date.now(),l=1e3/_,d=function e(){window.requestAnimationFrame(e);var n=Date.now(),t=n-g;t>l&&(g=n-t%l,c||p())},y=function(){c=!0},v=function(){c=!1},w=function(){m()},q=function(){return r.roms[a]},h=function(){var e=a+1;x(e>r.roms.length-1?0:e)},k=function(){var e=a-1;x(e<0?r.roms.length-1:e)},x=function(e){if(!s){s=!0,D.reset(),a=e;var t=r.roms[e];n.setGameLabel(t.name),(0,r.fetchRom)(t).then(function(e){D.load_content(e.value),v(),n.updateControls(t.keyMappings),s=!1})}},D=new t.Chip8;e=(0,i.createDisplay)(),n=(0,u.createUI)(y,w,h,k),(0,o.setupKeypad)(function(){return q().keyMappings},function(e){return D.press_key(e)},function(e){return D.release_key(e)}),x(0),window.requestAnimationFrame(d);
},{"../rs/Cargo.toml":"scas","./roms":"WfXF","./keypad":"cSo4","./display":"9EpD","./ui":"WzDL"}],"3Fhe":[function(require,module,exports) {
var t=null;function r(){return t||(t=e()),t}function e(){try{throw new Error}catch(r){var t=(""+r.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(t)return n(t[0])}return"/"}function n(t){return(""+t).replace(/^((?:https?|file|ftp):\/\/.+)\/[^\/]+$/,"$1")+"/"}exports.getBundleURL=r,exports.getBaseURL=n;
},{}],"21/1":[function(require,module,exports) {
var r=require("./bundle-url").getBundleURL;function e(r){Array.isArray(r)||(r=[r]);var e=r[r.length-1];try{return Promise.resolve(require(e))}catch(n){if("MODULE_NOT_FOUND"===n.code)return new u(function(n,i){t(r.slice(0,-1)).then(function(){return require(e)}).then(n,i)});throw n}}function t(r){return Promise.all(r.map(s))}var n={};function i(r,e){n[r]=e}module.exports=exports=e,exports.load=t,exports.register=i;var o={};function s(e){var t;if(Array.isArray(e)&&(t=e[1],e=e[0]),o[e])return o[e];var i=(e.substring(e.lastIndexOf(".")+1,e.length)||e).toLowerCase(),s=n[i];return s?o[e]=s(r()+e).then(function(r){return r&&module.bundle.register(t,r),r}):void 0}function u(r){this.executor=r,this.promise=null}u.prototype.then=function(r,e){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.then(r,e)},u.prototype.catch=function(r){return null===this.promise&&(this.promise=new Promise(this.executor)),this.promise.catch(r)};
},{"./bundle-url":"3Fhe"}],"fISM":[function(require,module,exports) {
var e;const t={};let n=null;function r(){return null!==n&&n.buffer===e.memory.buffer||(n=new Uint8Array(e.memory.buffer)),n}function _(e,t){return r().subarray(e/1,e/1+t)}let c=null;function i(){return null===c&&(c=e.__wbindgen_global_argument_ptr()),c}let u=null;function o(){return null!==u&&u.buffer===e.memory.buffer||(u=new Uint32Array(e.memory.buffer)),u}let s=0;function l(t){const n=e.__wbindgen_malloc(1*t.length);return r().set(t,n/1),s=t.length,n}let a=new TextDecoder("utf-8");function f(e,t){return a.decode(r().subarray(e,e+t))}const g=new Array(32);g.fill(void 0),g.push(void 0,null,!0,!1);let p=g.length;function h(e){p===g.length&&g.push(g.length+1);const t=p;return p=g[t],g[t]=e,t}function b(e){return g[e]}function d(e){e<36||(g[e]=p,p=e)}function w(t){e.__wbg_chip8_free(t)}t.__wbg_new_bc890df3e5e6a91d=function(e,t){let n=f(e,t);return h(new Function(n))},t.__wbg_call_e15b6aa0c6d3c93f=function(e,t){return h(b(e).call(b(t)))},t.__wbg_self_95ad3f1cddd5accc=function(e){return h(b(e).self)},t.__wbg_crypto_c93cc5a147e35422=function(e){return h(b(e).crypto)},t.__wbg_getRandomValues_58b46416ea7a33a2=function(e){return h(b(e).getRandomValues)},t.__wbg_getRandomValues_a3a3c2dd5494fd39=function(e,t,n){let r=_(t,n);b(e).getRandomValues(r)},t.__wbg_require_36a895f0a4ea0529=function(e,t){let n=f(e,t);return h(require(n))},t.__wbg_randomFillSync_f9cb7531d9c0b144=function(e,t,n){let r=_(t,n);b(e).randomFillSync(r)},t.__wbindgen_object_drop_ref=function(e){d(e)},t.__wbindgen_is_undefined=function(e){return void 0===b(e)?1:0},t.__wbindgen_jsval_eq=function(e,t){return b(e)===b(t)?1:0};class y{free(){const e=this.ptr;this.ptr=0,w(e)}constructor(){this.ptr=e.chip8_new()}get_contents(){const t=i();e.chip8_get_contents(t,this.ptr);const n=o(),r=n[t/4],c=n[t/4+1],u=_(r,c).slice();return e.__wbindgen_free(r,1*c),u}load_content(t){const n=l(t),r=s;try{return e.chip8_load_content(this.ptr,n,r)}finally{e.__wbindgen_free(n,1*r)}}execute_cycle(){return e.chip8_execute_cycle(this.ptr)}execute_next_op_code(){return e.chip8_execute_next_op_code(this.ptr)}press_key(t){return e.chip8_press_key(this.ptr,t)}release_key(t){return e.chip8_release_key(this.ptr,t)}release_all_keys(){return e.chip8_release_all_keys(this.ptr)}get_v_register(){const t=i();e.chip8_get_v_register(t,this.ptr);const n=o(),r=n[t/4],c=n[t/4+1],u=_(r,c).slice();return e.__wbindgen_free(r,1*c),u}get_i_register(){return e.chip8_get_i_register(this.ptr)}get_program_counter(){return e.chip8_get_program_counter(this.ptr)}reset(){return e.chip8_reset(this.ptr)}}function m(n){const r=fetch(n);let _;return(_="function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(r,{"./chip8_web":t}):r.then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,{"./chip8_web":t}))).then(({instance:t})=>{e=m.wasm=t.exports})}t.__wbindgen_throw=function(e,t){throw new Error(f(e,t))},t.Chip8=y;const x=Object.assign(m,t);module.exports=function(e){return x(e).then(()=>t)};
},{}],0:[function(require,module,exports) {
var b=require("21/1");b.register("wasm",require("fISM"));b.load([["chip8_web_bg.923c84a0.wasm","ZIGB"]]).then(function(){require("Y5Mt");});
},{}]},{},[0], null)
//# sourceMappingURL=/chip8/js.10b5d78b.map